import{d as S,u as L,r as k,i as $,c as a,h,t as f,a as t,j as R,w as d,k as j,l as B,e as C,b as m,m as N,o as s,f as y,n as A,F as U,q as W,_ as F,s as D,v as E,x as I}from"./index.c96e1530.js";const O={class:"question-container"},J={class:"question"},P={class:"text-h5 font-weight-medium text-center"},G={key:1,class:"carte-media"},H={key:0,controls:"",autoplay:"",loop:"",class:"video"},K=["src","type"],X={key:1,controls:"",autoplay:"",class:"audio"},Y=["src","type"],Z=["src"],ee={key:1,class:"carte-media"},te={key:0,controls:"",autoplay:"",loop:"",class:"video"},se=["src","type"],oe={key:1,controls:"",autoplay:"",loop:"",class:"audio"},ae=["src","type"],ne=["src"],le={key:2,class:"btn-container"},ie=S({__name:"Questions",props:{cartes:null},emits:["finish"],setup(q,{emit:p}){const _=q,x=L(),g=k(0),T=k(!1),b=k([]),M=k([]),e=$(()=>{const c=_.cartes.at(g.value);if(!c)return null;const u=c.rectoMediaType,n=c.rectoMedia?URL.createObjectURL(new Blob([c.rectoMedia.buffer],{type:u})):null,i=c.versoMediaType,o=c.versoMedia?URL.createObjectURL(new Blob([c.versoMedia.buffer],{type:i})):null;return{question:c,rectoUrl:n,versoUrl:o}}),w=async c=>{if(!e.value)return;const u=e.value.question;await x.answer(u,c==="success"),c==="success"?b.value.push(u):M.value.push(u),T.value=!1,g.value===_.cartes.length-1?(p("finish",{correct:b.value,failed:M.value}),g.value=0,b.value=[],M.value=[]):g.value+=1};return(c,u)=>(s(),a("div",O,[h("div",J,[h("h6",P," Question "+f(g.value+1)+" / "+f(q.cartes.length),1),t(e)?(s(),R(j,{key:0,variant:"tonal"},{default:d(()=>{var n,i,o,r;return[m(A,{class:"text-h6"},{default:d(()=>{var l,z,V,v;return[y(f(T.value?t(e).question.versoType==="text"?"R\xE9ponse Texte":(V=t(e).question.versoMediaType)!=null&&V.startsWith("video/")?"R\xE9ponse Video":(v=t(e).question.versoMediaType)!=null&&v.startsWith("audio/")?"R\xE9ponse Audio":"R\xE9ponse Image":t(e).question.rectoType==="text"?"Question Texte":(l=t(e).question.rectoMediaType)!=null&&l.startsWith("video/")?"Question Video":(z=t(e).question.rectoMediaType)!=null&&z.startsWith("audio/")?"Question Audio":"Question Image"),1)]}),_:1}),T.value?(s(),a(U,{key:1},[t(e).question.versoType==="text"?(s(),R(W,{key:0,class:"text-h6 text-center mt-4",style:{"white-space":"pre-line"}},{default:d(()=>[y(f(t(e).question.versoText),1)]),_:1})):t(e).versoUrl?(s(),a("div",ee,[(o=t(e).question.versoMediaType)!=null&&o.startsWith("video/")?(s(),a("video",te,[h("source",{src:t(e).versoUrl,type:t(e).question.versoMediaType},null,8,se)])):(r=t(e).question.versoMediaType)!=null&&r.startsWith("audio/")?(s(),a("video",oe,[h("source",{src:t(e).versoUrl,type:t(e).question.versoMediaType},null,8,ae)])):(s(),a("img",{key:2,src:t(e).versoUrl},null,8,ne))])):B("",!0)],64)):(s(),a(U,{key:0},[t(e).question.rectoType==="text"?(s(),R(W,{key:0,class:"text-h6 text-center mt-4",style:{"white-space":"pre-line"}},{default:d(()=>[y(f(t(e).question.rectoText),1)]),_:1})):t(e).rectoUrl?(s(),a("div",G,[(n=t(e).question.rectoMediaType)!=null&&n.startsWith("video/")?(s(),a("video",H,[h("source",{src:t(e).rectoUrl,type:t(e).question.rectoMediaType},null,8,K)])):(i=t(e).question.rectoMediaType)!=null&&i.startsWith("audio/")?(s(),a("video",X,[h("source",{src:t(e).rectoUrl,type:t(e).question.rectoMediaType},null,8,Y)])):(s(),a("img",{key:2,src:t(e).rectoUrl},null,8,Z))])):B("",!0)],64))]}),_:1})):B("",!0),T.value?(s(),a("div",le,[m(C,{size:"large",onClick:u[1]||(u[1]=()=>w("wrong"))},{default:d(()=>[y(" Faux ")]),_:1}),m(C,{size:"large",onClick:u[2]||(u[2]=()=>w("success"))},{default:d(()=>[y(" Juste ")]),_:1})])):(s(),R(C,{key:1,id:"answer-btn",size:"large",onClick:u[0]||(u[0]=n=>T.value=!0)},{default:d(()=>[y(" Montrer la r\xE9ponse ")]),_:1})),m(N,{"model-value":g.value,max:q.cartes.length-1},null,8,["model-value","max"])])]))}});const re=F(ie,[["__scopeId","data-v-59987d83"]]),ce=q=>{const p=[...q];for(let _=p.length-1;_>0;_--){const x=Math.floor(Math.random()*(_+1));[p[_],p[x]]=[p[x],p[_]]}return p},ue={class:"container mt-4 mt-md-8 mt-lg-12 mt-xl-16"},de={class:"text-h4 font-weight-medium"},_e={key:2,class:"categorie-list"},ve={class:"text-h5 font-weight-medium"},he={class:"theme-list"},pe={class:"text-h6 font-weight-regular"},fe={class:"selection-container"},me=S({__name:"Quizz",setup(q){const p=L(),_=k([]),x=k(null),g=k(!1),T=k([]),b=k([]),M=$(()=>p.listByCategories.map(({categorie:n,themes:i})=>({categorie:n,themes:i.map(({theme:o,cartes:r})=>{const l=_.value.find(({themeId:v})=>v===o.id);if(!l)return null;const z=r.slice(0,l.index).sort((v,Q)=>v.streakTime-Q.streakTime).map(({carte:v})=>v),V=r.slice(l.index).sort((v,Q)=>v.streakTime-Q.streakTime).map(({carte:v})=>v);return{theme:o,cartes:{selected:z,unselected:V}}}).filter(Boolean)}))),e=$(()=>!M.value.flatMap(({themes:n})=>n.flatMap(({cartes:i})=>i.selected)).length),w=(n,i)=>{const o=_.value.find(l=>l.themeId===n);if(!o)return;const r=o.index+(i==="minus"?-1:1);r<0||r>o.total||(o.index=r)},c=()=>{const n=M.value.flatMap(({themes:o})=>o.flatMap(({cartes:r})=>r.selected)),i=ce(n);x.value=i},u=({correct:n,failed:i})=>{T.value=n,b.value=i,g.value=!0};return D(()=>{_.value=p.listByCategories.reduce((n,i)=>[...n,...i.themes.map(({theme:o,toReviewCount:r,cartes:l})=>({themeId:o.id,index:r,total:l.length}))],[])}),(n,i)=>{var o;return s(),a("div",ue,[g.value?(s(),a(U,{key:0},[m(C,{to:"/",class:"text-subtitle-1",active:!1},{default:d(()=>[y("Menu")]),_:1}),h("h3",de," Score: "+f(T.value.length)+" / "+f((o=x.value)==null?void 0:o.length),1)],64)):x.value?(s(),R(re,{key:1,cartes:x.value,onFinish:u},null,8,["cartes"])):(s(),a("div",_e,[(s(!0),a(U,null,E(t(M),r=>(s(),a("div",{key:r.categorie.id},[h("h4",ve,f(r.categorie.title),1),h("ul",he,[(s(!0),a(U,null,E(r.themes,l=>(s(),a("li",{key:l.theme.id},[h("h6",pe,f(l.theme.title),1),h("div",fe,[m(C,{class:"custom-btn",size:"small",icon:"",variant:"text",onClick:()=>w(l.theme.id,"minus")},{default:d(()=>[m(I,null,{default:d(()=>[y("mdi-minus")]),_:1})]),_:2},1032,["onClick"]),h("span",null,f(l.cartes.selected.length)+" / "+f(l.cartes.selected.length+l.cartes.unselected.length),1),m(C,{class:"custom-btn",size:"small",icon:"",variant:"text",onClick:()=>w(l.theme.id,"plus")},{default:d(()=>[m(I,null,{default:d(()=>[y("mdi-plus")]),_:1})]),_:2},1032,["onClick"])])]))),128))])]))),128)),m(C,{class:"mt-4 mt-md-8 custom-btn",size:"large",onClick:c,disabled:t(e)},{default:d(()=>[y(" Commencer ")]),_:1},8,["disabled"])]))])}}});const xe=F(me,[["__scopeId","data-v-d8316b3f"]]);export{xe as default};
